const tabArray = [
  {
    title: 'Overview',
    icon: 'ğŸ ',
    content: 'Overview main content...',
    subTabs: [
      {title: 'Info', content:'Overview Info content.'},
      {title: 'Tips', content:'Overview Tips content.'}
    ]
  },
  {
    title: 'Stats',
    icon: 'ğŸ“Š',
    content: 'Stats main content...'
  },
  {
    title: 'Weapons',
    icon: 'ğŸ”«',
    content: 'Weapons main content...'
  },
    {
    title: 'vu progression',
    icon: 'ğŸ”«',
    content: `<p>ğŸ’¬ Chat Commands</p>

<b>These should be considered temporary until a proper UI can be built to view these stats.</b>
<b>!level or !score: Privately prints to the player all Class & General levels, score, and score </b>
<b>required for next unlock.</b>
<b>!kills [Weapon Name]: Prints number of kills for that weapon, kills required for next unlock,</b>
<b>and what that unlock will be.</b>
<b>!vs [Vehicle Type]: Does the same, but for Vehicle Score.</b>

<p>ğŸ® Usage</p>

<b>Join a server with a progression mod tag</b>
<b>Play as usual â€” progression is tracked automatically</b>
<b>Unlocks and ranks are saved between rounds or if you leave the server</b></p>

<p>ğŸ› ï¸ Development</p>

<b>Want to contribute? Hereâ€™s how:</b>

    <b>Fork the repo</b>
    <b>Create a feature branch</b>
    <b>Submit a pull request</b>

<b>The mod is written in VEXT (VeniceEXT) scripting, primarily in LUA.</b></p>
<p>ğŸš§ Roadmap</p>

<b> Global persistent tracking across multiple servers</b>
<b>Add Ribbons and challenges</b>
<b>Add dog tag unlocks</b>
<b>UI stats page</b>
<b>UI notifications for rank up / unlocks (like vanilla BF3)</b>
<b>Bugfixes</b>
<b>Possible non-BF3 features, such as Prestige</b>

<p>ğŸ Known Issues</p>

<b>Unlock notifications are currently minimal</b>
<b>Some awards may not track properly</b></p>
`
  }
];

function createTabs(tabs){
  const tabBar = document.getElementById('tabBar');
  const tabPages = document.getElementById('tabPages');
  tabs.forEach((tab, index)=>{
    // Create button
    const btn = document.createElement('div');
    btn.classList.add('tabButton');
    btn.innerHTML = `${tab.icon} ${tab.title}`;
    btn.dataset.tabId = 'tab'+index;
    tabBar.appendChild(btn);

    // Create tab content
    const tabContent = document.createElement('div');
    tabContent.classList.add('tabContent');
    tabContent.id = 'tab'+index;
    tabContent.innerHTML = `<div>${tab.content}</div>`;
    
    // Create sub-tabs if exist
    if(tab.subTabs){
      const subBar = document.createElement('div');
      subBar.classList.add('subTabs');
      const subPages = document.createElement('div');
      subPages.id = 'tab'+index+'SubPages';
      tab.subTabs.forEach((sub, sIndex)=>{
        const subBtn = document.createElement('div');
        subBtn.classList.add('subTabButton');
        subBtn.innerText = sub.title;
        subBtn.dataset.subId = `tab${index}Sub${sIndex}`;
        subBar.appendChild(subBtn);
        
        const subContent = document.createElement('div');
        subContent.classList.add('tabContent');
        subContent.id = `tab${index}Sub${sIndex}`;
        subContent.innerText = sub.content;
        subPages.appendChild(subContent);

        // Sub tab click
        subBtn.addEventListener('click', ()=>{
          Array.from(subPages.children).forEach(c=>{
            c.classList.remove('active');
          });
          Array.from(subBar.children).forEach(b=>{
            b.classList.remove('active');
          });
          subBtn.classList.add('active');
          subContent.classList.add('active');
        });

        // Set first sub-tab active
        if(sIndex===0){
          subBtn.classList.add('active');
          subContent.classList.add('active');
        }
      });
      tabContent.appendChild(subBar);
      tabContent.appendChild(subPages);
    }

    tabPages.appendChild(tabContent);

    // Button click
    btn.addEventListener('click', ()=>{
      Array.from(tabPages.children).forEach(c=>c.classList.remove('active'));
      Array.from(tabBar.children).forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      tabContent.classList.add('active');
      updateUnderline(btn);
    });

    // Set first tab active
    if(index===0){
      btn.classList.add('active');
      tabContent.classList.add('active');
      setTimeout(()=>updateUnderline(btn), 0);
    }
  });
  const panel = document.getElementById('infoPanel');
 panel.style.opacity='1';
  panel.style.transform='translateY(0)';
}

function updateUnderline(btn){
  const underline = document.getElementById('tabUnderline');
  const rect = btn.getBoundingClientRect();
  const parentRect = btn.parentElement.getBoundingClientRect();
  underline.style.left = (rect.left - parentRect.left)+'px';
  underline.style.width = rect.width+'px';
}

//window.onload = ()=>{
//  const panel = document.getElementById('infoPanel');
// panel.style.opacity='1';
//  panel.style.transform='translateY(0)';
//  createTabs(tabArray);
//};
function closePanel() {
  const panel = document.getElementById("infoPanel");

  panel.style.opacity = "0";
  panel.style.transform = "translateY(20px)";

  setTimeout(() => {
    panel.style.display = "none";
  }, 500); // matches your CSS transition
}